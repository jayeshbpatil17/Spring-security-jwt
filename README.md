<!DOCTYPE html>
<!-- saved from url=(0081)https://www.learncodewithdurgesh.com/blogs/jwt-authentication-with-spring-boot-31 -->
<html><script id="youtube-hd-fjdmkanbdloodhegphphhklnjfngoffa">var ythdlog = () => {};;var ythderror = () => {};</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="180x180" href="https://www.learncodewithdurgesh.com/Assets/Favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://www.learncodewithdurgesh.com/Assets/Favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://www.learncodewithdurgesh.com/Assets/Favicon/favicon-16x16.png"><link rel="manifest" href="https://www.learncodewithdurgesh.com/Assets/Favicon/site.webmanifest"><link rel="stylesheet" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/all.min.css"><title>Jwt Authentication with Spring Boot 3.1 | Learn Code With Durgesh</title><meta name="keywords" content="spring boot,spring boot 3.0.0,spring security,spring boot security,jwt,spring security jwt,jwt authentication spring boot,spring,spring boot 3,spring boot jwt,jwt spring boot,spring boot 3.0,implementing jwt authentication on spring boot api,spring boot with spring security using jwt,learn jwt authentication with spring boot in hindi,authentication,spring security jwt example,jwt authentication in spring boot,jwt authentication spring boot mysql"><meta name="description" content="In this blog we will learn about how to use JWT authentication with Spring Boot  3.1"><meta name="author" content="Learn Code With Durgesh"><meta name="next-head-count" content="11"><link rel="preload" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/1c107d979fc1bf43.css" as="style"><link rel="stylesheet" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/1c107d979fc1bf43.css" data-n-g=""><link rel="preload" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/a62c710ba57369f3.css" as="style"><link rel="stylesheet" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/a62c710ba57369f3.css" data-n-p=""><noscript data-n-css=""></noscript><script defer="" nomodule="" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/polyfills-c67a75d1b6f99dc8.js.download"></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/webpack-2df7a8d27de1794c.js.download" defer=""></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/framework-2c79e2a64abdb08b.js.download" defer=""></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/main-627138c22ebf06ea.js.download" defer=""></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/_app-2bbb879556cb140b.js.download" defer=""></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/160-faf0a447d91b7983.js.download" defer=""></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/377-dab50e3bbbf6e1ad.js.download" defer=""></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/373-acc4f66d86705151.js.download" defer=""></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/[dynamicBlogPage]-febdba16d1004d5b.js.download" defer=""></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/_buildManifest.js.download" defer=""></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/_ssgManifest.js.download" defer=""></script><link as="script" rel="prefetch" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/320-e82120a8cc7f336d.js.download"><link as="script" rel="prefetch" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/index-7135597394447cc0.js.download"><link as="script" rel="prefetch" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/940-1da800865165b55d.js.download"><link as="script" rel="prefetch" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/417-209f9c6545dd1cf3.js.download"><link as="script" rel="prefetch" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/blogs-d9105ab58414c63b.js.download"><link as="script" rel="prefetch" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/courses-eff54ba8c2ac8826.js.download"><link as="script" rel="prefetch" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/aboutus-416401f480d188ab.js.download"><link as="script" rel="prefetch" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/contact-us-34f812ae60582ee6.js.download"><link as="script" rel="prefetch" href="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/[category]-58d6b3faa4ef2b30.js.download"></head><body><div id="__next"><main class="w-screen lg:w-auto overflow-x-clip lg:overflow-x-visible  " style="margin-top: 114px;"><div class="Toastify"></div><style>
    #nprogress {
      pointer-events: none;
    }
    #nprogress .bar {
      background: #F59E0B;
      position: fixed;
      z-index: 9999;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
    }
    #nprogress .peg {
      display: block;
      position: absolute;
      right: 0px;
      width: 100px;
      height: 100%;
      box-shadow: 0 0 10px #F59E0B, 0 0 5px #F59E0B;
      opacity: 1;
      -webkit-transform: rotate(3deg) translate(0px, -4px);
      -ms-transform: rotate(3deg) translate(0px, -4px);
      transform: rotate(3deg) translate(0px, -4px);
    }
    #nprogress .spinner {
      display: block;
      position: fixed;
      z-index: 1031;
      top: 15px;
      right: 15px;
    }
    #nprogress .spinner-icon {
      width: 18px;
      height: 18px;
      box-sizing: border-box;
      border: solid 2px transparent;
      border-top-color: #F59E0B;
      border-left-color: #F59E0B;
      border-radius: 50%;
      -webkit-animation: nprogresss-spinner 400ms linear infinite;
      animation: nprogress-spinner 400ms linear infinite;
    }
    .nprogress-custom-parent {
      overflow: hidden;
      position: relative;
    }
    .nprogress-custom-parent #nprogress .spinner,
    .nprogress-custom-parent #nprogress .bar {
      position: absolute;
    }
    @-webkit-keyframes nprogress-spinner {
      0% {
        -webkit-transform: rotate(0deg);
      }
      100% {
        -webkit-transform: rotate(360deg);
      }
    }
    @keyframes nprogress-spinner {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }
  </style><div class="relative"><div class="fixed top-[90%] right-8 z-50 bg-purple-700 rounded-full overflow-clip p-3 cursor-pointer h-fit w-fit"><svg class="w-6 h-6 md:w-10 md:h-10 text-white animate-bounce" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5"></path></svg></div><div class="fixed w-full top-0" style="z-index:99"><div class="border-b border-b-blue-100 px-5 text-white py-3 bg-gradient-to-r from-pink-500 via-red-500 to-yellow-500 flex justify-around  bg-white "><div></div><div class="flex  flex-wrap justify-center items-center"><div><h1 class="font-bold">Unlock the power of knowledge with our premium courses! Use code LCWD100</h1></div><div class="px-5 pt-3 md:pt-0"><a target="_blank" class="bg-red-600   px-5 py-1 text-white rounded hover:bg-red-500 mx-5" href="https://courses.learncodewithdurgesh.com/learn">Click Here</a></div></div><div style="cursor: pointer;"><i class="fa fa-xmark "></i></div></div><div class="lg:hidden w-full"><div class="z-50   backdrop-blur-lg rounded-b-xl bg-neutral-300/20"><div class="flex flex-row justify-between px-2 py-1 h-16 "><div class="flex flex-col justify-center"><a class="flex flex-row" href="https://www.learncodewithdurgesh.com/"><img alt="LCWD Logo" srcset="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Flcwd_logo.45da3818.png&amp;w=640&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Flcwd_logo.45da3818.png&amp;w=1080&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/lcwd_logo.png" width="500" height="500" decoding="async" data-nimg="1" class="w-12" loading="lazy" style="color:transparent"><h1 class="ml-5 my-auto font-semibold text-[2rem] bg-gradient-to-r from-secondary-dark to-primary-dark bg-clip-text text-transparent"> LCWD </h1></a></div><div class="flex flex-col justify-center"><svg class="w-9 h-9" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg></div></div><div class="backdrop-blur-lg border-b-8 border-primary-dark hidden py-10 rounded-b-xl"><a href="https://www.learncodewithdurgesh.com/"><h1 class="mb-3 bg-primary-light hover:bg-primary-medium mx-auto w-48 py-0.5 rounded-xl text-center text-lg font-semibold">Home</h1></a><a href="https://www.learncodewithdurgesh.com/blogs"><h1 class="mb-3 bg-primary-light mx-auto w-48 py-0.5 rounded-xl text-center text-lg font-semibold">Blogs</h1></a><a target="_blank" href="https://courses.learncodewithdurgesh.com/learn"><h1 class="mb-3 bg-primary-light mx-auto w-48 py-0.5 rounded-xl text-center text-lg font-semibold">Premium Courses</h1></a><a href="https://www.learncodewithdurgesh.com/courses"><h1 class="mb-3 bg-primary-light mx-auto w-48 py-0.5 rounded-xl text-center text-lg font-semibold">Free Courses</h1></a><a href="https://www.learncodewithdurgesh.com/aboutus"><h1 class="mb-3 bg-primary-light mx-auto w-48 py-0.5 rounded-xl text-center text-lg font-semibold">About</h1></a><a href="https://www.learncodewithdurgesh.com/contact-us"><h1 class="mb-3 bg-primary-light mx-auto w-48 py-0.5 rounded-xl text-center text-lg font-semibold">Contact</h1></a><a class="bg-primary-light mx-auto w-48 py-0.5 rounded-xl text-lg font-semibold text-red-600 flex flex-row justify-center" target="_blank" href="https://www.youtube.com/learncodewithdurgesh"><img alt="Youtube Logo" srcset="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fyoutube.73587684.png&amp;w=640&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fyoutube.73587684.png&amp;w=1080&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/youtube.png" width="512" height="512" decoding="async" data-nimg="1" class="h-6 w-6 mr-2 my-auto" loading="lazy" style="color:transparent"><p>Youtube</p></a><a class="h-12 mx-auto w-28 mt-2 text-red-600 flex flex-row transition-all ease-linear hover:-translate-y-1" target="_blank" href="https://play.google.com/store/apps/details?id=com.learncodewithdurgesh.courses&amp;pcampaignid=web_share"><img alt="LCWD Logo" srcset="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fandroid_app_button.5dae9266.png&amp;w=384&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fandroid_app_button.5dae9266.png&amp;w=750&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/android_app_button.png" width="360" height="129" decoding="async" data-nimg="1" class="h-auto w-28  my-auto " loading="lazy" style="color:transparent"></a></div></div></div><div><div class="hidden lg:flex   top-0 left-0 right-0 backdrop-blur-lg bg-neutral-300/20 drop-shadow-2xl  flex-row justify-between lg:px-6 xl:px-20 py-1"><div><a class="flex flex-row" href="https://www.learncodewithdurgesh.com/"><img alt="LCWD Logo" srcset="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Flcwd_logo.45da3818.png&amp;w=640&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Flcwd_logo.45da3818.png&amp;w=1080&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/lcwd_logo.png" width="500" height="500" decoding="async" data-nimg="1" class="w-16" loading="lazy" style="color:transparent"><h1 class="ml-5 h-fit my-auto font-semibold text-4xl bg-gradient-to-r from-secondary-dark to-primary-dark bg-clip-text text-transparent">LCWD</h1></a></div><div class="flex flex-row cursor-default text-lg  font-semibold"><a class="mr-5 h-fit my-auto transition-all ease-linear hover:text-primary-dark hover:-translate-y-1" href="https://www.learncodewithdurgesh.com/">Home</a><a class="mr-5 h-fit my-auto transition-all ease-linear hover:text-primary-dark hover:-translate-y-1" href="https://www.learncodewithdurgesh.com/blogs">Blogs</a><a class="mr-5 h-fit my-auto text-red-600 transition-all ease-linear hover:text-primary-dark hover:-translate-y-1" target="_blank" href="https://courses.learncodewithdurgesh.com/learn">Premium Courses</a><a class="mr-5 h-fit my-auto transition-all ease-linear hover:text-primary-dark hover:-translate-y-1" href="https://www.learncodewithdurgesh.com/courses">Free Courses</a><a class="mr-5 h-fit my-auto transition-all ease-linear hover:text-primary-dark hover:-translate-y-1" href="https://www.learncodewithdurgesh.com/aboutus">About</a><a class="mr-5 h-fit my-auto transition-all ease-linear hover:text-primary-dark hover:-translate-y-1" href="https://www.learncodewithdurgesh.com/contact-us">Contact</a><a class="h-fit mr-5 my-auto  text-red-600 flex flex-row transition-all ease-linear hover:-translate-y-1" target="_blank" href="https://www.youtube.com/learncodewithdurgesh"><img alt="LCWD Logo" srcset="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fyoutube.73587684.png&amp;w=640&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fyoutube.73587684.png&amp;w=1080&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/youtube.png" width="512" height="512" decoding="async" data-nimg="1" class="h-6 w-6 mr-2 my-auto" loading="lazy" style="color:transparent"><p>Youtube</p></a><a class="h-12 my-auto text-red-600 flex flex-row transition-all ease-linear hover:-translate-y-1" target="_blank" href="https://play.google.com/store/apps/details?id=com.learncodewithdurgesh.courses&amp;pcampaignid=web_share"><img alt="LCWD Logo" srcset="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fandroid_app_button.5dae9266.png&amp;w=384&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fandroid_app_button.5dae9266.png&amp;w=750&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/android_app_button.png" width="360" height="129" decoding="async" data-nimg="1" class="h-auto w-28  my-auto " loading="lazy" style="color:transparent"></a></div></div></div></div><main><div class="relative"><div class="absolute -z-30 top-0 right-0 left-0 bg-bottom bg-cover brightness-90 h-[30rem] bg-singleBlogBannerImg p-5"></div><div class="z-40 h-[30rem] flex flex-col justify-center"><div class="rounded-3xl drop-shadow-2xl w-80 lg:w-fit mx-auto bg-zinc-400/30 lg:bg-zinc-300/60 backdrop-blur-2xl py-4"><h1 class="text-center text-primary-dark text-4xl lg:text-7xl font-[1000] px-5 lg:px-24 mt-3"></h1><h1 class="text-center text-primary-dark text-4xl lg:text-5xl font-semibold px-2 lg:px-12 mt-3">Jwt Authentication with Spring Boot 3.1</h1><h2 class="text-center text-white px-5 lg:px-5 font-semibold lg:text-2xl my-4"></h2></div></div></div><div class="mx-2 md:mx-0  grid grid-cols-1 lg:grid-cols-12"><div class="hidden lg:block w-64 relative bg-stone-50 drop-shadow-xl"><div class="sticky top-28 mb-16 mx-5"><div class="w-fit py-2 mx-auto font-semibold text-primary-dark my-5 text-3xl flex flex-row space-x-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor" class="w-6 h-auto"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12h-15"></path></svg><h1 class="underline underline-offset-4">Categories</h1><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor" class="w-6 h-auto"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12h-15"></path></svg></div><div class=" text-lg space-y-4"><a class="block" href="https://www.learncodewithdurgesh.com/blogs"><div class="flex flex-row justify-center cursor-pointer border-2 border-sky-400 text-secondary-dark bg-white hover:border-secondary-dark hover:text-white hover:bg-sky-400 transition-all ease-linear rounded-xl py-1 uppercase"><p class="font-medium">All Blogs</p></div></a><a class="block" href="https://www.learncodewithdurgesh.com/blogs/category/3/Technology"><div class="flex flex-row justify-center cursor-pointer border-2  border-sky-400 text-secondary-dark bg-white hover:border-secondary-dark hover:text-white hover:bg-sky-400  transition-all ease-linear rounded-xl py-1 uppercase"><p class="font-medium">Technology</p></div></a><a class="block" href="https://www.learncodewithdurgesh.com/blogs/category/1/Programming"><div class="flex flex-row justify-center cursor-pointer border-2  border-sky-400 text-secondary-dark bg-white hover:border-secondary-dark hover:text-white hover:bg-sky-400  transition-all ease-linear rounded-xl py-1 uppercase"><p class="font-medium">Programming</p></div></a><a class="block" href="https://www.learncodewithdurgesh.com/blogs/category/4/How%20to%20earn%20more"><div class="flex flex-row justify-center cursor-pointer border-2  border-sky-400 text-secondary-dark bg-white hover:border-secondary-dark hover:text-white hover:bg-sky-400  transition-all ease-linear rounded-xl py-1 uppercase"><p class="font-medium">How to earn more</p></div></a><a class="block" href="https://www.learncodewithdurgesh.com/blogs/category/2/Other"><div class="flex flex-row justify-center cursor-pointer border-2  border-sky-400 text-secondary-dark bg-white hover:border-secondary-dark hover:text-white hover:bg-sky-400  transition-all ease-linear rounded-xl py-1 uppercase"><p class="font-medium">Other</p></div></a></div></div></div><div class="lg:hidden z-40 flex flex-row justify-end p-4"><div class="relative" data-headlessui-state=""><div><button class="text-xl font-semibold rounded-md bg-secondary-medium px-4 py-2" id="headlessui-menu-button-:R6d75m:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state="">Categories</button></div></div></div><div class="lg:col-start-4 xl:col-start-3 lg:col-span-8 lg:pl-2 xl:pl-8 2xl:pl-0 mt-4"><div><div><h1 class="undefined heading-blog mt-5 mb-2">JWT Authentication with Spring Boot 3.0</h1>
<p class="undefined para-blog"><div class="flex flex-row justify-center mt-3 "><img alt="" srcset="/_next/image?url=https%3A%2F%2Flcwdapi.learncodewithdurgesh.com%2Fmedia%2Fblogs%2Fjwt_boot.png&amp;w=1080&amp;q=75 1x, /_next/image?url=https%3A%2F%2Flcwdapi.learncodewithdurgesh.com%2Fmedia%2Fblogs%2Fjwt_boot.png&amp;w=2048&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/jwt_boot.png" width="985" height="554" decoding="async" data-nimg="1" class="max-w-full h-auto  shadow-sm " loading="lazy" style="color: transparent;"></div></p>
<ul>
<li>We will see how to configure InMemory user and jwt authentication using latest spring boot 3.0.</li>
<li>We will create one protected endpoint and try to secure endpoint using spring boot security.</li>
</ul>
<h2 class="undefined heading-blog mt-5 mb-2">Create new Spring Boot Project</h2>
<ul>
<li>Go to spring initializer and create new project with dependencies</li>
<li>add the following dependencies</li>
<li>For Web</li>
</ul>
<div class="code-toolbar"><pre class="language-markup" tabindex="0"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<ul>
<li>For security</li>
</ul>
<div class="code-toolbar"><pre class="language-markup" tabindex="0"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<ul>
<li>Lombok</li>
</ul>
<div class="code-toolbar"><pre class="language-markup" tabindex="0"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<ul>
<li>For JWT</li>
</ul>
<div class="code-toolbar"><pre class="language-markup" tabindex="0"><code class="language-markup"> <span class="token comment">&lt;!-- https://mvnrepository.com/artifact/io.jsonwebtoken/jjwt-api --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.jsonwebtoken<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jjwt-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.11.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>


     <span class="token comment">&lt;!-- https://mvnrepository.com/artifact/io.jsonwebtoken/jjwt-impl --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.jsonwebtoken<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jjwt-impl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.11.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.jsonwebtoken<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jjwt-jackson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- or jjwt-gson if Gson is preferred --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.11.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p class="undefined para-blog">&nbsp;</p>
<h2 class="undefined heading-blog mt-5 mb-2">Create End Point to be secured</h2>
<div class="code-toolbar"><pre class="language-java" tabindex="0"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HomeController</span> <span class="token punctuation">{</span>

    <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">HomeController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/test"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"This is working message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"Testing message"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p class="undefined para-blog"><strong>Use can create the same that we developed in video.</strong></p>
<h2 class="undefined heading-blog mt-5 mb-2">Create InMemory user with UserDetailService Bean</h2>
<p class="undefined para-blog">Create UserDetailService bean and write the InMemory user implementation</p>
<p class="undefined para-blog">Create CustomConfig class and create bean and also create two important bean PasswordEncoder and AuthenticationManager so that we can use later.</p>
<p class="undefined para-blog">&nbsp;</p>
<div class="code-toolbar"><pre class="language-java" tabindex="0"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">class</span> <span class="token class-name">MyConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">UserDetailsService</span> <span class="token function">userDetailsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UserDetails</span> userDetails <span class="token operator">=</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
                <span class="token function">username</span><span class="token punctuation">(</span><span class="token string">"DURGESH"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">"DURGESH"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">roles</span><span class="token punctuation">(</span><span class="token string">"ADMIN"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
                <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryUserDetailsManager</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">PasswordEncoder</span> <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">AuthenticationManager</span> <span class="token function">authenticationManager</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationConfiguration</span> builder<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">getAuthenticationManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p class="undefined para-blog">Now we can login with given username and password by default spring security provide form login .</p>
<p class="undefined para-blog">open browser and open</p>
<div class="code-toolbar"><pre class="language-markup" tabindex="0"><code class="language-markup">http://localhost:8080/test</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p class="undefined para-blog">when login form is prompted just login with username and password as given .</p>
<hr>
<h3 class="undefined heading-blog mt-5 mb-2">JWT Authentication Flow</h3>
<p class="undefined para-blog"><div class="flex flex-row justify-center mt-3 "><img alt="" srcset="/_next/image?url=https%3A%2F%2Flcwdapi.learncodewithdurgesh.com%2Fmedia%2Fblogs%2Fjwt_flow.jpg&amp;w=1080&amp;q=75 1x, /_next/image?url=https%3A%2F%2Flcwdapi.learncodewithdurgesh.com%2Fmedia%2Fblogs%2Fjwt_flow.jpg&amp;w=1920&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/jwt_flow.jpeg" width="863" height="609" decoding="async" data-nimg="1" class="max-w-full h-auto  shadow-sm " loading="lazy" style="color: transparent;"></div></p>
<p class="undefined para-blog">&nbsp;</p>
<h3 class="undefined heading-blog mt-5 mb-2">Steps to implement jwt token:</h3>
<p class="undefined para-blog"><strong>1)&nbsp;</strong> Make sure&nbsp;<code>spring-boot-starter-security</code> is there in pom.xml</p>
<p class="undefined para-blog"><strong>2)&nbsp; </strong>Create Class&nbsp;<code>JWTAthenticationEntryPoint</code>&nbsp;that implement&nbsp;<code>AuthenticationEntryPoint</code>. Method of this class is called whenever as exception is thrown due to unauthenticated user trying to access the resource that required authentication.</p>
<div class="code-toolbar"><pre class="language-java" tabindex="0"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JwtAuthenticationEntryPoint</span> <span class="token keyword">implements</span> <span class="token class-name">AuthenticationEntryPoint</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">commence</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">AuthenticationException</span> authException<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">.</span><span class="token constant">SC_UNAUTHORIZED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrintWriter</span> writer <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Access Denied !! "</span> <span class="token operator">+</span> authException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p class="undefined para-blog"><strong>3)</strong>&nbsp; Create <code><strong>JWTHelper</strong> </code>&nbsp;class This class contains method related to perform operations with jwt token like generateToken, validateToken etc.</p>
<div class="code-toolbar"><pre class="language-java" tabindex="0"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JwtHelper</span> <span class="token punctuation">{</span>

    <span class="token comment">//requirement :</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">JWT_TOKEN_VALIDITY</span> <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">;</span>

    <span class="token comment">//    public static final long JWT_TOKEN_VALIDITY =  60;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> secret <span class="token operator">=</span> <span class="token string">"afafasfafafasfasfasfafacasdasfasxASFACASDFACASDFASFASFDAFASFASDAADSCSDFADCVSGCFVADXCcadwavfsfarvf"</span><span class="token punctuation">;</span>

    <span class="token comment">//retrieve username from jwt token</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUsernameFromToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getClaimFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token class-name">Claims</span><span class="token operator">::</span><span class="token function">getSubject</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//retrieve expiration date from jwt token</span>
    <span class="token keyword">public</span> <span class="token class-name">Date</span> <span class="token function">getExpirationDateFromToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getClaimFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token class-name">Claims</span><span class="token operator">::</span><span class="token function">getExpiration</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">getClaimFromToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Claims</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> claimsResolver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token function">getAllClaimsFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> claimsResolver<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>claims<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//for retrieveing any information from token we will need the secret key</span>
    <span class="token keyword">private</span> <span class="token class-name">Claims</span> <span class="token function">getAllClaimsFromToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//check if the token has expired</span>
    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> <span class="token function">isTokenExpired</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">Date</span> expiration <span class="token operator">=</span> <span class="token function">getExpirationDateFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> expiration<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//generate token for user</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">generateToken</span><span class="token punctuation">(</span><span class="token class-name">UserDetails</span> userDetails<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> claims <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">doGenerateToken</span><span class="token punctuation">(</span>claims<span class="token punctuation">,</span> userDetails<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//while creating the token -</span>
    <span class="token comment">//1. Define  claims of the token, like Issuer, Expiration, Subject, and the ID</span>
    <span class="token comment">//2. Sign the JWT using the HS512 algorithm and secret key.</span>
    <span class="token comment">//3. According to JWS Compact Serialization(https://tools.ietf.org/html/draft-ietf-jose-json-web-signature-41#section-3.1)</span>
    <span class="token comment">//   compaction of the JWT to a URL-safe string</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">doGenerateToken</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> claims<span class="token punctuation">,</span> <span class="token class-name">String</span> subject<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">return</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setClaims</span><span class="token punctuation">(</span>claims<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span>subject<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setIssuedAt</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setExpiration</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">JWT_TOKEN_VALIDITY</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">signWith</span><span class="token punctuation">(</span><span class="token class-name">SignatureAlgorithm</span><span class="token punctuation">.</span><span class="token constant">HS512</span><span class="token punctuation">,</span> secret<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//validate token</span>
    <span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">validateToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">,</span> <span class="token class-name">UserDetails</span> userDetails<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token function">getUsernameFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>username<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isTokenExpired</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p class="undefined para-blog"><strong>4)&nbsp;</strong>Create&nbsp;<code>JWTAuthenticationFilter</code>&nbsp;that extends&nbsp;<code>OncePerRequestFilter</code>&nbsp;and override method and write the logic to check the token that is comming in header. We have to write 5 important logic</p>
<ol>
<li style="list-style-type: none;">
<ol>
<li>Get Token from request</li>
<li>Validate Token</li>
<li>GetUsername from token</li>
<li>Load user associated with this token</li>
<li>set authentication</li>
</ol>
</li>
</ol>
<div class="code-toolbar"><pre class="language-java" tabindex="0"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JwtAuthenticationFilter</span> <span class="token keyword">extends</span> <span class="token class-name">OncePerRequestFilter</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">OncePerRequestFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">JwtHelper</span> jwtHelper<span class="token punctuation">;</span>


    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserDetailsService</span> userDetailsService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doFilterInternal</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> filterChain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

<span class="token comment">//        try {</span>
<span class="token comment">//            Thread.sleep(500);</span>
<span class="token comment">//        } catch (InterruptedException e) {</span>
<span class="token comment">//            throw new RuntimeException(e);</span>
<span class="token comment">//        }</span>
        <span class="token comment">//Authorization</span>

        <span class="token class-name">String</span> requestHeader <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">"Authorization"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Bearer 2352345235sdfrsfgsdfsdf</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">" Header :  {}"</span><span class="token punctuation">,</span> requestHeader<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> token <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>requestHeader <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> requestHeader<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"Bearer"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//looking good</span>
            token <span class="token operator">=</span> requestHeader<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>

                username <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>jwtHelper<span class="token punctuation">.</span><span class="token function">getUsernameFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IllegalArgumentException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Illegal Argument while fetching the username !!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ExpiredJwtException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Given jwt token is expired !!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">MalformedJwtException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Some changed has done in token !! Invalid Token"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span>


        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Invalid Header Value !! "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token comment">//</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>


            <span class="token comment">//fetch user detail from username</span>
            <span class="token class-name">UserDetails</span> userDetails <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userDetailsService<span class="token punctuation">.</span><span class="token function">loadUserByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Boolean</span> validateToken <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>jwtHelper<span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> userDetails<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>validateToken<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token comment">//set the authentication</span>
                <span class="token class-name">UsernamePasswordAuthenticationToken</span> authentication <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> userDetails<span class="token punctuation">.</span><span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                authentication<span class="token punctuation">.</span><span class="token function">setDetails</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WebAuthenticationDetailsSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">buildDetails</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAuthentication</span><span class="token punctuation">(</span>authentication<span class="token punctuation">)</span><span class="token punctuation">;</span>


            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Validation fails !!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>


        <span class="token punctuation">}</span>

        filterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p class="undefined para-blog"><strong>5)</strong> Configure spring security in configuration file:</p>
<div class="code-toolbar"><pre class="language-java" tabindex="0"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token punctuation">{</span>


    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">JwtAuthenticationEntryPoint</span> point<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">JwtAuthenticationFilter</span> filter<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">SecurityFilterChain</span> <span class="token function">securityFilterChain</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

        http<span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span>csrf <span class="token operator">-&gt;</span> csrf<span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
                <span class="token function">requestMatchers</span><span class="token punctuation">(</span><span class="token string">"/test"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">requestMatchers</span><span class="token punctuation">(</span><span class="token string">"/auth/login"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exceptionHandling</span><span class="token punctuation">(</span>ex <span class="token operator">-&gt;</span> ex<span class="token punctuation">.</span><span class="token function">authenticationEntryPoint</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">sessionManagement</span><span class="token punctuation">(</span>session <span class="token operator">-&gt;</span> session<span class="token punctuation">.</span><span class="token function">sessionCreationPolicy</span><span class="token punctuation">(</span><span class="token class-name">SessionCreationPolicy</span><span class="token punctuation">.</span><span class="token constant">STATELESS</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        http<span class="token punctuation">.</span><span class="token function">addFilterBefore</span><span class="token punctuation">(</span>filter<span class="token punctuation">,</span> <span class="token class-name">UsernamePasswordAuthenticationFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> http<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p class="undefined para-blog"><strong>6)</strong> Create JWTRequest and JWTResponse to receive request data and send Login success response.</p>
<p class="undefined para-blog"><strong>7)</strong>&nbsp; Create login api to accept username and password and return token if username and password is correct.</p>
<div class="code-toolbar"><pre class="language-java" tabindex="0"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/auth"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserDetailsService</span> userDetailsService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AuthenticationManager</span> manager<span class="token punctuation">;</span>


    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">JwtHelper</span> helper<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">AuthController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JwtResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">JwtRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doAuthenticate</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token class-name">UserDetails</span> userDetails <span class="token operator">=</span> userDetailsService<span class="token punctuation">.</span><span class="token function">loadUserByUsername</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> token <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>helper<span class="token punctuation">.</span><span class="token function">generateToken</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JwtResponse</span> response <span class="token operator">=</span> <span class="token class-name">JwtResponse</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">jwtToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">username</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">OK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">doAuthenticate</span><span class="token punctuation">(</span><span class="token class-name">String</span> email<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">UsernamePasswordAuthenticationToken</span> authentication <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">(</span>email<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            manager<span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span>authentication<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">BadCredentialsException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BadCredentialsException</span><span class="token punctuation">(</span><span class="token string">" Invalid Username or Password  !!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">BadCredentialsException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">exceptionHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"Credentials Invalid !!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p class="undefined para-blog"><strong>8) </strong>Test Application.</p>
<p class="undefined para-blog">&nbsp;</p>
<p class="undefined para-blog"><iframe src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/q2l91Ffc_8U.html" width="600" height="750" allowfullscreen="" style="width: 100%; height: 750px;"></iframe></p></div></div><div class="mx-auto w-[90%] bg-stone-50 drop-shadow-xl lg:hidden"><div><div><div style="text-align:left;overflow:hidden"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7974805835239751" data-ad-slot="4773097025" data-ad-format="auto" data-full-width-responsive="true"></ins></div></div></div></div><div><div style="text-align:left;overflow:hidden"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7974805835239751" data-ad-slot="6173528129" data-ad-format="auto" data-full-width-responsive="true"></ins></div></div><div><div class="py-3"><h1 class="p-5 underline underline-offset-8 lg:text-5xl text-primary-dark text-center text-2xl font-bold">Trending Blogs</h1><div class="slick-slider my-10 overflow-clip mx-auto slick-initialized" dir="ltr"><button type="button" data-role="none" class="slick-arrow slick-prev" style="display: block;"> Previous</button><div class="slick-list"><div class="slick-track" style="opacity: 1; transform: translate3d(-1875px, 0px, 0px); width: 4125px; transition: -webkit-transform 1500ms ease 0s;"><div data-index="-3" tabindex="-1" class="slick-slide slick-cloned" aria-hidden="true" style="width: 375px;"><div><div class="my-12 mx-5 flex flex-col justify-between max-w-sm min-h-[24rem] overflow-hidden shadow-lg  rounded-xl border-b-secondary-medium border-b-8 drop-shadow-xl bg-card-color"><div class="px-6 py-4"><div class="font-bold text-xl mb-2">How to Earn in Lakhs Every Month as a Coder</div><div class="text-gray-700 text-base line-clamp-6">If you're a coder, you know that there are many ways to make money. You can get a job at a tech company, freelance, or start your own business. But what if you want to earn even more money? Here are a few ways to do just that:</div></div><div class="px-6 pt-4 pb-2"><a class="inline-block bg-green-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs/how-to-earn-in-lakhs-every-month-as-a-coder">Read</a><a class="inline-block bg-red-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs">Blogs</a><a class="inline-block bg-blue-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" target="_blank" href="https://courses.learncodewithdurgesh.com/">Premium Courses</a></div></div></div></div><div data-index="-2" tabindex="-1" class="slick-slide slick-cloned" aria-hidden="true" style="width: 375px;"><div><div class="my-12 mx-5 flex flex-col justify-between max-w-sm min-h-[24rem] overflow-hidden shadow-lg  rounded-xl border-b-secondary-medium border-b-8 drop-shadow-xl bg-card-color"><div class="px-6 py-4"><div class="font-bold text-xl mb-2">Jwt Authentication with Spring Boot 3.1</div><div class="text-gray-700 text-base line-clamp-6">In this blog we will learn about how to use JWT authentication with Spring Boot  3.1</div></div><div class="px-6 pt-4 pb-2"><a class="inline-block bg-green-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs/jwt-authentication-with-spring-boot-31">Read</a><a class="inline-block bg-red-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs">Blogs</a><a class="inline-block bg-blue-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" target="_blank" href="https://courses.learncodewithdurgesh.com/">Premium Courses</a></div></div></div></div><div data-index="-1" tabindex="-1" class="slick-slide slick-cloned" aria-hidden="true" style="width: 375px;"><div><div class="my-12 mx-5 flex flex-col justify-between max-w-sm min-h-[24rem] overflow-hidden shadow-lg  rounded-xl border-b-secondary-medium border-b-8 drop-shadow-xl bg-card-color"><div class="px-6 py-4"><div class="font-bold text-xl mb-2">10 steps to deploy Angular App to Netlify</div><div class="text-gray-700 text-base line-clamp-6">In this blog we will see how to deploy angular app to netlify step by step in 10 steps.</div></div><div class="px-6 pt-4 pb-2"><a class="inline-block bg-green-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs/10-steps-to-deploy-angular-app-to-netlify">Read</a><a class="inline-block bg-red-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs">Blogs</a><a class="inline-block bg-blue-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" target="_blank" href="https://courses.learncodewithdurgesh.com/">Premium Courses</a></div></div></div></div><div data-index="0" class="slick-slide" tabindex="-1" aria-hidden="true" style="outline: none; width: 375px;"><div><div class="my-12 mx-5 flex flex-col justify-between max-w-sm min-h-[24rem] overflow-hidden shadow-lg  rounded-xl border-b-secondary-medium border-b-8 drop-shadow-xl bg-card-color"><div class="px-6 py-4"><div class="font-bold text-xl mb-2">Best Coding Laptops in Amazon Great Indian Festival</div><div class="text-gray-700 text-base line-clamp-6">The Amazon Great Indian Festival is a great time to buy a new laptop, especially if you're a coder. There are a lot of great deals on laptops, and it can be hard to decide which one is right for you.  Here are a few things to keep in mind when choosing a coding laptop:</div></div><div class="px-6 pt-4 pb-2"><a class="inline-block bg-green-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs/best-coding-laptops-in-amazon-great-indian-festival">Read</a><a class="inline-block bg-red-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs">Blogs</a><a class="inline-block bg-blue-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" target="_blank" href="https://courses.learncodewithdurgesh.com/">Premium Courses</a></div></div></div></div><div data-index="1" class="slick-slide" tabindex="-1" aria-hidden="true" style="outline: none; width: 375px;"><div><div class="my-12 mx-5 flex flex-col justify-between max-w-sm min-h-[24rem] overflow-hidden shadow-lg  rounded-xl border-b-secondary-medium border-b-8 drop-shadow-xl bg-card-color"><div class="px-6 py-4"><div class="font-bold text-xl mb-2">How to Earn in Lakhs Every Month as a Coder</div><div class="text-gray-700 text-base line-clamp-6">If you're a coder, you know that there are many ways to make money. You can get a job at a tech company, freelance, or start your own business. But what if you want to earn even more money? Here are a few ways to do just that:</div></div><div class="px-6 pt-4 pb-2"><a class="inline-block bg-green-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs/how-to-earn-in-lakhs-every-month-as-a-coder">Read</a><a class="inline-block bg-red-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs">Blogs</a><a class="inline-block bg-blue-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" target="_blank" href="https://courses.learncodewithdurgesh.com/">Premium Courses</a></div></div></div></div><div data-index="2" class="slick-slide slick-active slick-current" tabindex="-1" aria-hidden="false" style="outline: none; width: 375px;"><div><div class="my-12 mx-5 flex flex-col justify-between max-w-sm min-h-[24rem] overflow-hidden shadow-lg  rounded-xl border-b-secondary-medium border-b-8 drop-shadow-xl bg-card-color"><div class="px-6 py-4"><div class="font-bold text-xl mb-2">Jwt Authentication with Spring Boot 3.1</div><div class="text-gray-700 text-base line-clamp-6">In this blog we will learn about how to use JWT authentication with Spring Boot  3.1</div></div><div class="px-6 pt-4 pb-2"><a class="inline-block bg-green-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs/jwt-authentication-with-spring-boot-31">Read</a><a class="inline-block bg-red-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs">Blogs</a><a class="inline-block bg-blue-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" target="_blank" href="https://courses.learncodewithdurgesh.com/">Premium Courses</a></div></div></div></div><div data-index="3" class="slick-slide slick-active" tabindex="-1" aria-hidden="false" style="outline: none; width: 375px;"><div><div class="my-12 mx-5 flex flex-col justify-between max-w-sm min-h-[24rem] overflow-hidden shadow-lg  rounded-xl border-b-secondary-medium border-b-8 drop-shadow-xl bg-card-color"><div class="px-6 py-4"><div class="font-bold text-xl mb-2">10 steps to deploy Angular App to Netlify</div><div class="text-gray-700 text-base line-clamp-6">In this blog we will see how to deploy angular app to netlify step by step in 10 steps.</div></div><div class="px-6 pt-4 pb-2"><a class="inline-block bg-green-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs/10-steps-to-deploy-angular-app-to-netlify">Read</a><a class="inline-block bg-red-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs">Blogs</a><a class="inline-block bg-blue-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" target="_blank" href="https://courses.learncodewithdurgesh.com/">Premium Courses</a></div></div></div></div><div data-index="4" tabindex="-1" class="slick-slide slick-active slick-cloned" aria-hidden="false" style="width: 375px;"><div><div class="my-12 mx-5 flex flex-col justify-between max-w-sm min-h-[24rem] overflow-hidden shadow-lg  rounded-xl border-b-secondary-medium border-b-8 drop-shadow-xl bg-card-color"><div class="px-6 py-4"><div class="font-bold text-xl mb-2">Best Coding Laptops in Amazon Great Indian Festival</div><div class="text-gray-700 text-base line-clamp-6">The Amazon Great Indian Festival is a great time to buy a new laptop, especially if you're a coder. There are a lot of great deals on laptops, and it can be hard to decide which one is right for you.  Here are a few things to keep in mind when choosing a coding laptop:</div></div><div class="px-6 pt-4 pb-2"><a class="inline-block bg-green-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs/best-coding-laptops-in-amazon-great-indian-festival">Read</a><a class="inline-block bg-red-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs">Blogs</a><a class="inline-block bg-blue-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" target="_blank" href="https://courses.learncodewithdurgesh.com/">Premium Courses</a></div></div></div></div><div data-index="5" tabindex="-1" class="slick-slide slick-cloned" aria-hidden="true" style="width: 375px;"><div><div class="my-12 mx-5 flex flex-col justify-between max-w-sm min-h-[24rem] overflow-hidden shadow-lg  rounded-xl border-b-secondary-medium border-b-8 drop-shadow-xl bg-card-color"><div class="px-6 py-4"><div class="font-bold text-xl mb-2">How to Earn in Lakhs Every Month as a Coder</div><div class="text-gray-700 text-base line-clamp-6">If you're a coder, you know that there are many ways to make money. You can get a job at a tech company, freelance, or start your own business. But what if you want to earn even more money? Here are a few ways to do just that:</div></div><div class="px-6 pt-4 pb-2"><a class="inline-block bg-green-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs/how-to-earn-in-lakhs-every-month-as-a-coder">Read</a><a class="inline-block bg-red-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs">Blogs</a><a class="inline-block bg-blue-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" target="_blank" href="https://courses.learncodewithdurgesh.com/">Premium Courses</a></div></div></div></div><div data-index="6" tabindex="-1" class="slick-slide slick-cloned" aria-hidden="true" style="width: 375px;"><div><div class="my-12 mx-5 flex flex-col justify-between max-w-sm min-h-[24rem] overflow-hidden shadow-lg  rounded-xl border-b-secondary-medium border-b-8 drop-shadow-xl bg-card-color"><div class="px-6 py-4"><div class="font-bold text-xl mb-2">Jwt Authentication with Spring Boot 3.1</div><div class="text-gray-700 text-base line-clamp-6">In this blog we will learn about how to use JWT authentication with Spring Boot  3.1</div></div><div class="px-6 pt-4 pb-2"><a class="inline-block bg-green-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs/jwt-authentication-with-spring-boot-31">Read</a><a class="inline-block bg-red-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs">Blogs</a><a class="inline-block bg-blue-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" target="_blank" href="https://courses.learncodewithdurgesh.com/">Premium Courses</a></div></div></div></div><div data-index="7" tabindex="-1" class="slick-slide slick-cloned" aria-hidden="true" style="width: 375px;"><div><div class="my-12 mx-5 flex flex-col justify-between max-w-sm min-h-[24rem] overflow-hidden shadow-lg  rounded-xl border-b-secondary-medium border-b-8 drop-shadow-xl bg-card-color"><div class="px-6 py-4"><div class="font-bold text-xl mb-2">10 steps to deploy Angular App to Netlify</div><div class="text-gray-700 text-base line-clamp-6">In this blog we will see how to deploy angular app to netlify step by step in 10 steps.</div></div><div class="px-6 pt-4 pb-2"><a class="inline-block bg-green-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs/10-steps-to-deploy-angular-app-to-netlify">Read</a><a class="inline-block bg-red-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" href="https://www.learncodewithdurgesh.com/blogs">Blogs</a><a class="inline-block bg-blue-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2" target="_blank" href="https://courses.learncodewithdurgesh.com/">Premium Courses</a></div></div></div></div></div></div><button type="button" data-role="none" class="slick-arrow slick-next" style="display: block;"> Next</button></div></div></div></div><div class="hidden lg:block ml-8 bg-stone-50 drop-shadow-xl col-span-2 relative"><div class="sticky top-28"><div><div style="text-align:left;overflow:hidden"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7974805835239751" data-ad-slot="4773097025" data-ad-format="auto" data-full-width-responsive="true"></ins></div><div style="text-align:left;overflow:hidden"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7974805835239751" data-ad-slot="4773097025" data-ad-format="auto" data-full-width-responsive="true"></ins></div></div></div></div></div><div class="bg-gray-500 flex flex-col justify-center py-12"><h3 class="w-fit mx-auto text-white text-center font-semibold text-2xl lg:text-4xl">Help Others, Please Share</h3><div class="mt-8 grid grid-cols-1 smd:grid-cols-2 smd:gap-x-5 px-14 md:px-11 gap-y-5 lg:space-y-0 lg:px-0 lg:flex lg:flex-row lg:justify-center lg:space-x-5"><a class="group border-4 border-blue-500 text-blue-600 hover:text-white bg-white hover:bg-blue-500 transition-all ease-linear flex flex-row justify-center rounded-3xl py-2.5 md:py-4 px-5 space-x-4" href="https://facebook.com/sharer/sharer.php?u=https://learncodewithdurgesh.com/blogs/jwt-authentication-with-spring-boot-31" target="_blank" rel="noreferrer" aria-label="Share on Facebook"><div class="h-fit my-auto transition-all ease-linear"><svg class="w-7 h-7 md:w-10 md:h-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"></path></svg></div><p class="h-fit my-auto font-semibold text-md md:text-xl"> Share on Facebook </p></a><a class="group border-4 border-green-500 text-green-500 hover:text-white bg-white hover:bg-green-500 transition-all ease-linear flex flex-row rounded-3xl py-2.5 md:py-4 px-5 space-x-4" href="whatsapp://send?text=Jwt%20Authentication%20with%20Spring%20Boot%203.1https://learncodewithdurgesh.com/blogs/jwt-authentication-with-spring-boot-31" target="_blank" rel="noreferrer" aria-label="Share on WhatsApp"><div class="h-fit my-auto transition-all ease-linear"><svg class="w-7 h-7 md:w-10 md:h-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3 0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7 0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1 0-5.2 4.2-9.4 9.4-9.4 2.5 0 4.9 1 6.7 2.8 1.8 1.8 2.8 4.2 2.8 6.7-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2-.2-.3 0-.5.1-.6s.3-.3.4-.5c.2-.1.3-.3.4-.5.1-.2 0-.4 0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"></path></svg></div><p class="h-fit my-auto font-semibold text-md md:text-xl"> Share on WhatsApp </p></a><a class="group border-4 border-sky-500 text-sky-600 hover:text-white bg-white hover:bg-sky-500 transition-all ease-linear flex flex-row rounded-3xl py-2.5 md:py-4 px-5 space-x-4" href="https://www.linkedin.com/shareArticle?url=https://learncodewithdurgesh.com/blogs/jwt-authentication-with-spring-boot-31" target="_blank" rel="noreferrer" aria-label="Share on LinkedIn"><div class="h-fit my-auto transition-all ease-linear"><svg class="w-7 h-7 md:w-10 md:h-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"></path></svg></div><p class="h-fit my-auto font-semibold text-md md:text-xl"> Share on LinkedIn </p></a><a class="group border-4 border-cyan-500 text-cyan-600 hover:text-white bg-white hover:bg-cyan-500 transition-all ease-linear flex flex-row rounded-3xl py-2.5 md:py-4 px-5 space-x-4" href="https://twitter.com/share?url=https://learncodewithdurgesh.com/blogs/jwt-authentication-with-spring-boot-31" target="_blank" rel="noreferrer" aria-label="Share on Twitter"><div class="h-fit my-auto transition-all ease-linear"><svg class="w-7 h-7 md:w-10 md:h-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"></path></svg></div><p class="h-fit my-auto font-semibold text-md md:text-xl"> Share on Twitter </p></a></div></div></main><div class="bg-primary-light text-gray-700 py-5 cursor-default underline-offset-4 selection:bg-secondary-dark selection:text-white px-5"><div class="flex flex-col justify-center lg:flex-row lg:space-x-12"><div class="flex flex-col w-72 mx-auto lg:mx-0"><img alt="LCWD LOGO" srcset="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Flcwd_logo.45da3818.png&amp;w=640&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Flcwd_logo.45da3818.png&amp;w=1080&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/lcwd_logo.png" width="500" height="500" decoding="async" data-nimg="1" class="w-20 mx-auto mb-2 lg:w-20 xl:w-24" loading="lazy" style="color:transparent"><h1 class="font-bold text-lg text-center underline mb-3 xl:text-xl">Learn Code With Durgesh</h1><p class="text-justify lg:text-left xl:text-justify text-sm xl:text-base">Learn Code With Durgesh offers wide variety of free and Premium courses on YouTube channel and website. We are serving lakhs of students and professionals.</p><h3 class="mt-4 text-2xl font-bold text-center">!! Happy Coding !!</h3></div><div class="flex flex-col justify-around py-4 px-3 mx-auto lg:mx-0"><h1 class="font-semibold text-lg text-center underline xl:text-xl">Products</h1><div><a target="_blank" class="hover:text-secondary-dark transition-all ease-linear" href="https://courses.learncodewithdurgesh.com/learn/Master-Spring-Boot-With-Project"><p class="my-3 text-sm lg:mb-5 lg:my-0 xl:text-base">Master Spring Boot With Project Course</p></a><a target="_blank" class="hover:text-secondary-dark transition-all ease-linear" href="https://courses.learncodewithdurgesh.com/learn/Ecommerce-using-React-js"><p class="my-3 text-sm lg:mb-5 lg:my-0 xl:text-base">React Js Ecommerce Project Course</p></a><a target="_blank" class="hover:text-secondary-dark transition-all ease-linear" href="https://courses.learncodewithdurgesh.com/learn/Fullstack-React-Spring-Boot"><p class="my-3 text-sm lg:mb-5 lg:my-0 xl:text-base">React + Spring Boot Full Stack</p></a><a class="hover:text-secondary-dark transition-all ease-linear" href="https://www.learncodewithdurgesh.com/courses"><p class="my-3 text-sm lg:mb-5 lg:my-0 xl:text-base">Free Courses</p></a></div></div><div class="flex flex-col justify-around py-4 px-3 mx-auto lg:mx-0"><h1 class="font-semibold text-lg text-center underline xl:text-xl">Contact</h1><div class="flex flex-row justify-start text-sm my-3 xl:text-base lg:my-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 lg:w-6 lg:h-6 mr-4"><path fill-rule="evenodd" d="M11.54 22.351l.07.04.028.016a.76.76 0 00.723 0l.028-.015.071-.041a16.975 16.975 0 001.144-.742 19.58 19.58 0 002.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 00-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 002.682 2.282 16.975 16.975 0 001.145.742zM12 13.5a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path></svg><div><p> Substring Technologies, Vijayeepur ,</p><p> Vishesh Khand 2 Gomti Nagar, Lucknow, INDIA, 226010 </p></div></div><div class="flex flex-row justify-start text-sm mb-3 xl:text-base lg:mb-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 lg:w-6 lg:h-6 mr-4"><path d="M19.5 22.5a3 3 0 003-3v-8.174l-6.879 4.022 3.485 1.876a.75.75 0 01-.712 1.321l-5.683-3.06a1.5 1.5 0 00-1.422 0l-5.683 3.06a.75.75 0 01-.712-1.32l3.485-1.877L1.5 11.326V19.5a3 3 0 003 3h15z"></path><path d="M1.5 9.589v-.745a3 3 0 011.578-2.641l7.5-4.039a3 3 0 012.844 0l7.5 4.039A3 3 0 0122.5 8.844v.745l-8.426 4.926-.652-.35a3 3 0 00-2.844 0l-.652.35L1.5 9.59z"></path></svg><p> learncodewithdurgesh@gmail.com </p></div><div class="flex flex-row justify-start text-sm mb-3 xl:text-base lg:mb-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 lg:w-6 lg:h-6 mr-4"><path fill-rule="evenodd" d="M1.5 4.5a3 3 0 013-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 01-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 006.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 011.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 01-3 3h-2.25C8.552 22.5 1.5 15.448 1.5 6.75V4.5z" clip-rule="evenodd"></path></svg><p>+91-9839466732</p></div></div><div class="hidden lg:block rounded-full my-5 border border-black"></div><div class="flex flex-col justify-around py-4 px-3 mx-auto lg:mx-0"><h1 class="font-semibold text-lg text-center underline xl:text-xl">Get In Touch</h1><div class="mt-3 flex flex-col justify-around h-full space-y-5"><div class="flex flex-row text-sm mr-3 xl:text-base lg:mr-24 hover:text-secondary-dark transition-all ease-linear"><img alt="youtubeLogo" srcset="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fyoutube.73587684.png&amp;w=640&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fyoutube.73587684.png&amp;w=1080&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/youtube.png" width="512" height="512" decoding="async" data-nimg="1" class="w-5 lg:w-6 mr-1 lg:mr-4" loading="lazy" style="color:transparent"><a href="https://www.youtube.com/learncodewithdurgesh" rel="noreferrer" target="_blank">YouTube</a></div><div class="flex flex-row text-sm mr-3 xl:text-base hover:text-secondary-dark transition-all ease-linear"><img alt="facebookLogo" srcset="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Ffacebook.eb5d4246.png&amp;w=640&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Ffacebook.eb5d4246.png&amp;w=1080&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/facebook.png" width="512" height="512" decoding="async" data-nimg="1" class="w-5 lg:w-6 mr-1 lg:mr-4" loading="lazy" style="color:transparent"><a href="https://www.facebook.com/learncodewithdurgesh" rel="noreferrer" target="_blank">Facebook</a></div><div class="flex flex-row text-sm mr-3 xl:text-base hover:text-secondary-dark transition-all ease-linear"><img alt="instagramLogo" srcset="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Finstagram.a35eda2b.png&amp;w=640&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Finstagram.a35eda2b.png&amp;w=1080&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/instagram.png" width="512" height="512" decoding="async" data-nimg="1" class="w-5 lg:w-6 mr-1 lg:mr-4" loading="lazy" style="color:transparent"><a href="https://instagram.com/durgesh_k_t" rel="noreferrer" target="_blank">Instagram</a></div><div class="flex flex-row text-sm mr-3 xl:text-base hover:text-secondary-dark transition-all ease-linear"><img alt="linkedinLogo" srcset="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Flinkedin.80aba7be.png&amp;w=640&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Flinkedin.80aba7be.png&amp;w=1080&amp;q=75 2x" src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/linkedin.png" width="512" height="512" decoding="async" data-nimg="1" class="w-5 lg:w-6 mr-1 lg:mr-4" loading="lazy" style="color:transparent"><a href="https://www.linkedin.com/in/durgeshkumartiwari/" rel="noreferrer" target="_blank">Linkedin</a></div></div></div></div><div class="border border-black my-2 lg:mx-20 lg:my-6"></div><div class="flex flex-col justify-center text-sm lg:flex-row lg:text-lg"><div class="flex flex-row justify-center"><p>Copyright  2023:<a class="font-bold underline cursor-pointer hover:text-secondary-dark transition-all ease-linear"> Substring Technologies Pvt Ltd. </a></p></div><p class="text-center">&nbsp;&nbsp;All Rights Reserved.</p></div><div class="w-fit mx-auto text-center mt-4 font-bold underline flex flex-col md:flex-row md:space-x-10"><a class="hover:text-secondary-dark transition-all ease-linear" rel="noreferrer" href="https://courses.learncodewithdurgesh.com/refund.html" target="_blank">Refund Policy</a><a class="hover:text-secondary-dark transition-all ease-linear" rel="noreferrer" href="https://courses.learncodewithdurgesh.com/privacy-policy.html" target="_blank">Privacy Policy</a><a class="hover:text-secondary-dark transition-all ease-linear" rel="noreferrer" href="https://courses.learncodewithdurgesh.com/terms-of-service.html" target="_blank">Terms of Service</a></div></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"blog":{"url":"http://lcwdapi.learncodewithdurgesh.com/api/v1/blogs/30/","id":30,"title":"Jwt Authentication with Spring Boot 3.1","short_description":"In this blog we will learn about how to use JWT authentication with Spring Boot  3.1","keywords":"spring boot,spring boot 3.0.0,spring security,spring boot security,jwt,spring security jwt,jwt authentication spring boot,spring,spring boot 3,spring boot jwt,jwt spring boot,spring boot 3.0,implementing jwt authentication on spring boot api,spring boot with spring security using jwt,learn jwt authentication with spring boot in hindi,authentication,spring security jwt example,jwt authentication in spring boot,jwt authentication spring boot mysql","content":"\u003ch1\u003eJWT Authentication with Spring Boot 3.0\u003c/h1\u003e\r\n\u003cp\u003e\u003cimg src=\"media/blogs/jwt_boot.png\" alt=\"\" width=\"985\" height=\"554\"\u003e\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eWe will see how to configure InMemory user and jwt authentication using latest spring boot 3.0.\u003c/li\u003e\r\n\u003cli\u003eWe will create one protected endpoint and try to secure endpoint using spring boot security.\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch2\u003eCreate new Spring Boot Project\u003c/h2\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eGo to spring initializer and create new project with dependencies\u003c/li\u003e\r\n\u003cli\u003eadd the following dependencies\u003c/li\u003e\r\n\u003cli\u003eFor Web\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cpre class=\"language-markup\"\u003e\u003ccode\u003e\u0026lt;dependency\u0026gt;\r\n    \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt;\r\n    \u0026lt;artifactId\u0026gt;spring-boot-starter-web\u0026lt;/artifactId\u0026gt;\r\n\u0026lt;/dependency\u0026gt;\u003c/code\u003e\u003c/pre\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eFor security\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cpre class=\"language-markup\"\u003e\u003ccode\u003e\u0026lt;dependency\u0026gt;\r\n    \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt;\r\n    \u0026lt;artifactId\u0026gt;spring-boot-starter-security\u0026lt;/artifactId\u0026gt;\r\n\u0026lt;/dependency\u0026gt;\u003c/code\u003e\u003c/pre\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eLombok\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cpre class=\"language-markup\"\u003e\u003ccode\u003e\u0026lt;dependency\u0026gt;\r\n    \u0026lt;groupId\u0026gt;org.projectlombok\u0026lt;/groupId\u0026gt;\r\n    \u0026lt;artifactId\u0026gt;lombok\u0026lt;/artifactId\u0026gt;\r\n    \u0026lt;optional\u0026gt;true\u0026lt;/optional\u0026gt;\r\n\u0026lt;/dependency\u0026gt;\u003c/code\u003e\u003c/pre\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eFor JWT\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cpre class=\"language-markup\"\u003e\u003ccode\u003e \u0026lt;!-- https://mvnrepository.com/artifact/io.jsonwebtoken/jjwt-api --\u0026gt;\r\n\u0026lt;dependency\u0026gt;\r\n    \u0026lt;groupId\u0026gt;io.jsonwebtoken\u0026lt;/groupId\u0026gt;\r\n    \u0026lt;artifactId\u0026gt;jjwt-api\u0026lt;/artifactId\u0026gt;\r\n    \u0026lt;version\u0026gt;0.11.5\u0026lt;/version\u0026gt;\r\n\u0026lt;/dependency\u0026gt;\r\n\r\n\r\n     \u0026lt;!-- https://mvnrepository.com/artifact/io.jsonwebtoken/jjwt-impl --\u0026gt;\r\n\u0026lt;dependency\u0026gt;\r\n    \u0026lt;groupId\u0026gt;io.jsonwebtoken\u0026lt;/groupId\u0026gt;\r\n    \u0026lt;artifactId\u0026gt;jjwt-impl\u0026lt;/artifactId\u0026gt;\r\n    \u0026lt;version\u0026gt;0.11.5\u0026lt;/version\u0026gt;\r\n    \u0026lt;scope\u0026gt;runtime\u0026lt;/scope\u0026gt;\r\n\u0026lt;/dependency\u0026gt;\r\n\r\n\u0026lt;dependency\u0026gt;\r\n    \u0026lt;groupId\u0026gt;io.jsonwebtoken\u0026lt;/groupId\u0026gt;\r\n    \u0026lt;artifactId\u0026gt;jjwt-jackson\u0026lt;/artifactId\u0026gt; \u0026lt;!-- or jjwt-gson if Gson is preferred --\u0026gt;\r\n    \u0026lt;version\u0026gt;0.11.5\u0026lt;/version\u0026gt;\r\n    \u0026lt;scope\u0026gt;runtime\u0026lt;/scope\u0026gt;\r\n\u0026lt;/dependency\u0026gt;\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e\u0026nbsp;\u003c/p\u003e\r\n\u003ch2\u003eCreate End Point to be secured\u003c/h2\u003e\r\n\u003cpre class=\"language-java\"\u003e\u003ccode\u003e@RestController\r\npublic class HomeController {\r\n\r\n    Logger logger = LoggerFactory.getLogger(HomeController.class);\r\n\r\n    @RequestMapping(\"/test\")\r\n    public String test() {\r\n        this.logger.warn(\"This is working message\");\r\n        return \"Testing message\";\r\n    }\r\n\r\n\r\n}\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e\u003cstrong\u003eUse can create the same that we developed in video.\u003c/strong\u003e\u003c/p\u003e\r\n\u003ch2\u003eCreate InMemory user with UserDetailService Bean\u003c/h2\u003e\r\n\u003cp\u003eCreate UserDetailService bean and write the InMemory user implementation\u003c/p\u003e\r\n\u003cp\u003eCreate CustomConfig class and create bean and also create two important bean PasswordEncoder and AuthenticationManager so that we can use later.\u003c/p\u003e\r\n\u003cp\u003e\u0026nbsp;\u003c/p\u003e\r\n\u003cpre class=\"language-java\"\u003e\u003ccode\u003e@Configuration\r\nclass MyConfig {\r\n    @Bean\r\n    public UserDetailsService userDetailsService() {\r\n        UserDetails userDetails = User.builder().\r\n                username(\"DURGESH\")\r\n                .password(passwordEncoder().encode(\"DURGESH\")).roles(\"ADMIN\").\r\n                build();\r\n        return new InMemoryUserDetailsManager(userDetails);\r\n    }\r\n\r\n    @Bean\r\n    public PasswordEncoder passwordEncoder() {\r\n        return new BCryptPasswordEncoder();\r\n    }\r\n\r\n    @Bean\r\n    public AuthenticationManager authenticationManager(AuthenticationConfiguration builder) throws Exception {\r\n        return builder.getAuthenticationManager();\r\n    }\r\n}\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eNow we can login with given username and password by default spring security provide form login .\u003c/p\u003e\r\n\u003cp\u003eopen browser and open\u003c/p\u003e\r\n\u003cpre class=\"language-markup\"\u003e\u003ccode\u003ehttp://localhost:8080/test\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003ewhen login form is prompted just login with username and password as given .\u003c/p\u003e\r\n\u003chr\u003e\r\n\u003ch3\u003eJWT Authentication Flow\u003c/h3\u003e\r\n\u003cp\u003e\u003cimg src=\"media/blogs/jwt_flow.jpg\" alt=\"\" width=\"863\" height=\"609\"\u003e\u003c/p\u003e\r\n\u003cp\u003e\u0026nbsp;\u003c/p\u003e\r\n\u003ch3\u003eSteps to implement jwt token:\u003c/h3\u003e\r\n\u003cp\u003e\u003cstrong\u003e1)\u0026nbsp;\u003c/strong\u003e Make sure\u0026nbsp;\u003ccode\u003espring-boot-starter-security\u003c/code\u003e is there in pom.xml\u003c/p\u003e\r\n\u003cp\u003e\u003cstrong\u003e2)\u0026nbsp; \u003c/strong\u003eCreate Class\u0026nbsp;\u003ccode\u003eJWTAthenticationEntryPoint\u003c/code\u003e\u0026nbsp;that implement\u0026nbsp;\u003ccode\u003eAuthenticationEntryPoint\u003c/code\u003e. Method of this class is called whenever as exception is thrown due to unauthenticated user trying to access the resource that required authentication.\u003c/p\u003e\r\n\u003cpre class=\"language-java\"\u003e\u003ccode\u003e@Component\r\npublic class JwtAuthenticationEntryPoint implements AuthenticationEntryPoint {\r\n    @Override\r\n    public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) throws IOException, ServletException {\r\n        response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);\r\n        PrintWriter writer = response.getWriter();\r\n        writer.println(\"Access Denied !! \" + authException.getMessage());\r\n    }\r\n}\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e\u003cstrong\u003e3)\u003c/strong\u003e\u0026nbsp; Create \u003ccode\u003e\u003cstrong\u003eJWTHelper\u003c/strong\u003e \u003c/code\u003e\u0026nbsp;class This class contains method related to perform operations with jwt token like generateToken, validateToken etc.\u003c/p\u003e\r\n\u003cpre class=\"language-java\"\u003e\u003ccode\u003e@Component\r\npublic class JwtHelper {\r\n\r\n    //requirement :\r\n    public static final long JWT_TOKEN_VALIDITY = 5 * 60 * 60;\r\n\r\n    //    public static final long JWT_TOKEN_VALIDITY =  60;\r\n    private String secret = \"afafasfafafasfasfasfafacasdasfasxASFACASDFACASDFASFASFDAFASFASDAADSCSDFADCVSGCFVADXCcadwavfsfarvf\";\r\n\r\n    //retrieve username from jwt token\r\n    public String getUsernameFromToken(String token) {\r\n        return getClaimFromToken(token, Claims::getSubject);\r\n    }\r\n\r\n    //retrieve expiration date from jwt token\r\n    public Date getExpirationDateFromToken(String token) {\r\n        return getClaimFromToken(token, Claims::getExpiration);\r\n    }\r\n\r\n    public \u0026lt;T\u0026gt; T getClaimFromToken(String token, Function\u0026lt;Claims, T\u0026gt; claimsResolver) {\r\n        final Claims claims = getAllClaimsFromToken(token);\r\n        return claimsResolver.apply(claims);\r\n    }\r\n\r\n    //for retrieveing any information from token we will need the secret key\r\n    private Claims getAllClaimsFromToken(String token) {\r\n        return Jwts.parser().setSigningKey(secret).parseClaimsJws(token).getBody();\r\n    }\r\n\r\n    //check if the token has expired\r\n    private Boolean isTokenExpired(String token) {\r\n        final Date expiration = getExpirationDateFromToken(token);\r\n        return expiration.before(new Date());\r\n    }\r\n\r\n    //generate token for user\r\n    public String generateToken(UserDetails userDetails) {\r\n        Map\u0026lt;String, Object\u0026gt; claims = new HashMap\u0026lt;\u0026gt;();\r\n        return doGenerateToken(claims, userDetails.getUsername());\r\n    }\r\n\r\n    //while creating the token -\r\n    //1. Define  claims of the token, like Issuer, Expiration, Subject, and the ID\r\n    //2. Sign the JWT using the HS512 algorithm and secret key.\r\n    //3. According to JWS Compact Serialization(https://tools.ietf.org/html/draft-ietf-jose-json-web-signature-41#section-3.1)\r\n    //   compaction of the JWT to a URL-safe string\r\n    private String doGenerateToken(Map\u0026lt;String, Object\u0026gt; claims, String subject) {\r\n\r\n        return Jwts.builder().setClaims(claims).setSubject(subject).setIssuedAt(new Date(System.currentTimeMillis()))\r\n                .setExpiration(new Date(System.currentTimeMillis() + JWT_TOKEN_VALIDITY * 1000))\r\n                .signWith(SignatureAlgorithm.HS512, secret).compact();\r\n    }\r\n\r\n    //validate token\r\n    public Boolean validateToken(String token, UserDetails userDetails) {\r\n        final String username = getUsernameFromToken(token);\r\n        return (username.equals(userDetails.getUsername()) \u0026amp;\u0026amp; !isTokenExpired(token));\r\n    }\r\n\r\n\r\n}\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e\u003cstrong\u003e4)\u0026nbsp;\u003c/strong\u003eCreate\u0026nbsp;\u003ccode\u003eJWTAuthenticationFilter\u003c/code\u003e\u0026nbsp;that extends\u0026nbsp;\u003ccode\u003eOncePerRequestFilter\u003c/code\u003e\u0026nbsp;and override method and write the logic to check the token that is comming in header. We have to write 5 important logic\u003c/p\u003e\r\n\u003col\u003e\r\n\u003cli style=\"list-style-type: none;\"\u003e\r\n\u003col\u003e\r\n\u003cli\u003eGet Token from request\u003c/li\u003e\r\n\u003cli\u003eValidate Token\u003c/li\u003e\r\n\u003cli\u003eGetUsername from token\u003c/li\u003e\r\n\u003cli\u003eLoad user associated with this token\u003c/li\u003e\r\n\u003cli\u003eset authentication\u003c/li\u003e\r\n\u003c/ol\u003e\r\n\u003c/li\u003e\r\n\u003c/ol\u003e\r\n\u003cpre class=\"language-java\"\u003e\u003ccode\u003e@Component\r\npublic class JwtAuthenticationFilter extends OncePerRequestFilter {\r\n\r\n    private Logger logger = LoggerFactory.getLogger(OncePerRequestFilter.class);\r\n    @Autowired\r\n    private JwtHelper jwtHelper;\r\n\r\n\r\n    @Autowired\r\n    private UserDetailsService userDetailsService;\r\n\r\n    @Override\r\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {\r\n\r\n//        try {\r\n//            Thread.sleep(500);\r\n//        } catch (InterruptedException e) {\r\n//            throw new RuntimeException(e);\r\n//        }\r\n        //Authorization\r\n\r\n        String requestHeader = request.getHeader(\"Authorization\");\r\n        //Bearer 2352345235sdfrsfgsdfsdf\r\n        logger.info(\" Header :  {}\", requestHeader);\r\n        String username = null;\r\n        String token = null;\r\n        if (requestHeader != null \u0026amp;\u0026amp; requestHeader.startsWith(\"Bearer\")) {\r\n            //looking good\r\n            token = requestHeader.substring(7);\r\n            try {\r\n\r\n                username = this.jwtHelper.getUsernameFromToken(token);\r\n\r\n            } catch (IllegalArgumentException e) {\r\n                logger.info(\"Illegal Argument while fetching the username !!\");\r\n                e.printStackTrace();\r\n            } catch (ExpiredJwtException e) {\r\n                logger.info(\"Given jwt token is expired !!\");\r\n                e.printStackTrace();\r\n            } catch (MalformedJwtException e) {\r\n                logger.info(\"Some changed has done in token !! Invalid Token\");\r\n                e.printStackTrace();\r\n            } catch (Exception e) {\r\n                e.printStackTrace();\r\n\r\n            }\r\n\r\n\r\n        } else {\r\n            logger.info(\"Invalid Header Value !! \");\r\n        }\r\n\r\n\r\n        //\r\n        if (username != null \u0026amp;\u0026amp; SecurityContextHolder.getContext().getAuthentication() == null) {\r\n\r\n\r\n            //fetch user detail from username\r\n            UserDetails userDetails = this.userDetailsService.loadUserByUsername(username);\r\n            Boolean validateToken = this.jwtHelper.validateToken(token, userDetails);\r\n            if (validateToken) {\r\n\r\n                //set the authentication\r\n                UsernamePasswordAuthenticationToken authentication = new UsernamePasswordAuthenticationToken(userDetails, null, userDetails.getAuthorities());\r\n                authentication.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\r\n                SecurityContextHolder.getContext().setAuthentication(authentication);\r\n\r\n\r\n            } else {\r\n                logger.info(\"Validation fails !!\");\r\n            }\r\n\r\n\r\n        }\r\n\r\n        filterChain.doFilter(request, response);\r\n\r\n\r\n    }\r\n}\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e\u003cstrong\u003e5)\u003c/strong\u003e Configure spring security in configuration file:\u003c/p\u003e\r\n\u003cpre class=\"language-java\"\u003e\u003ccode\u003e@Configuration\r\npublic class SecurityConfig {\r\n\r\n\r\n    @Autowired\r\n    private JwtAuthenticationEntryPoint point;\r\n    @Autowired\r\n    private JwtAuthenticationFilter filter;\r\n\r\n    @Bean\r\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\r\n\r\n        http.csrf(csrf -\u0026gt; csrf.disable())\r\n                .authorizeRequests().\r\n                requestMatchers(\"/test\").authenticated().requestMatchers(\"/auth/login\").permitAll()\r\n                .anyRequest()\r\n                .authenticated()\r\n                .and().exceptionHandling(ex -\u0026gt; ex.authenticationEntryPoint(point))\r\n                .sessionManagement(session -\u0026gt; session.sessionCreationPolicy(SessionCreationPolicy.STATELESS));\r\n        http.addFilterBefore(filter, UsernamePasswordAuthenticationFilter.class);\r\n        return http.build();\r\n    }\r\n\r\n\r\n}\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e\u003cstrong\u003e6)\u003c/strong\u003e Create JWTRequest and JWTResponse to receive request data and send Login success response.\u003c/p\u003e\r\n\u003cp\u003e\u003cstrong\u003e7)\u003c/strong\u003e\u0026nbsp; Create login api to accept username and password and return token if username and password is correct.\u003c/p\u003e\r\n\u003cpre class=\"language-java\"\u003e\u003ccode\u003e@RestController\r\n@RequestMapping(\"/auth\")\r\npublic class AuthController {\r\n\r\n    @Autowired\r\n    private UserDetailsService userDetailsService;\r\n\r\n    @Autowired\r\n    private AuthenticationManager manager;\r\n\r\n\r\n    @Autowired\r\n    private JwtHelper helper;\r\n\r\n    private Logger logger = LoggerFactory.getLogger(AuthController.class);\r\n\r\n\r\n    @PostMapping(\"/login\")\r\n    public ResponseEntity\u0026lt;JwtResponse\u0026gt; login(@RequestBody JwtRequest request) {\r\n\r\n        this.doAuthenticate(request.getEmail(), request.getPassword());\r\n\r\n\r\n        UserDetails userDetails = userDetailsService.loadUserByUsername(request.getEmail());\r\n        String token = this.helper.generateToken(userDetails);\r\n\r\n        JwtResponse response = JwtResponse.builder()\r\n                .jwtToken(token)\r\n                .username(userDetails.getUsername()).build();\r\n        return new ResponseEntity\u0026lt;\u0026gt;(response, HttpStatus.OK);\r\n    }\r\n\r\n    private void doAuthenticate(String email, String password) {\r\n\r\n        UsernamePasswordAuthenticationToken authentication = new UsernamePasswordAuthenticationToken(email, password);\r\n        try {\r\n            manager.authenticate(authentication);\r\n\r\n\r\n        } catch (BadCredentialsException e) {\r\n            throw new BadCredentialsException(\" Invalid Username or Password  !!\");\r\n        }\r\n\r\n    }\r\n\r\n    @ExceptionHandler(BadCredentialsException.class)\r\n    public String exceptionHandler() {\r\n        return \"Credentials Invalid !!\";\r\n    }\r\n\r\n}\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e\u003cstrong\u003e8) \u003c/strong\u003eTest Application.\u003c/p\u003e\r\n\u003cp\u003e\u0026nbsp;\u003c/p\u003e\r\n\u003cp\u003e\u003ciframe style=\"width: 100%; height: 750px;\" src=\"https://www.youtube.com/embed/q2l91Ffc_8U\" width=\"600\" height=\"750\" allowfullscreen=\"allowfullscreen\"\u003e\u003c/iframe\u003e\u003c/p\u003e","added":"2023-06-12T12:29:06.084782Z","updated":"2023-06-12T14:40:00.282000Z","slug":"jwt-authentication-with-spring-boot-31","hide":false,"category":"http://lcwdapi.learncodewithdurgesh.com/api/v1/blog-categories/1/"}},"__N_SSP":true},"page":"/blogs/[dynamicBlogPage]","query":{"dynamicBlogPage":"jwt-authentication-with-spring-boot-31"},"buildId":"8xHICH9XAQIwSN5iaQyAe","isFallback":false,"gssp":true,"scriptLoader":[]}</script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/f.txt" data-ad-client="ca-pub-7974805835239751" async="true" data-nscript="afterInteractive"></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/js" data-nscript="afterInteractive"></script><script id="nextjs-google-analytics" data-nscript="afterInteractive">
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            false
            gtag('config', 'UA-119534368-3', {
              page_path: window.location.pathname,
              
            });
          </script><next-route-announcer><p aria-live="assertive" id="__next-route-announcer__" role="alert" style="border: 0px; clip: rect(0px, 0px, 0px, 0px); height: 1px; margin: -1px; overflow: hidden; padding: 0px; position: absolute; width: 1px; white-space: nowrap; overflow-wrap: normal;"></p></next-route-announcer><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/320-e82120a8cc7f336d.js.download"></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/index-7135597394447cc0.js.download"></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/aboutus-416401f480d188ab.js.download"></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/courses-eff54ba8c2ac8826.js.download"></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/940-1da800865165b55d.js.download"></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/417-209f9c6545dd1cf3.js.download"></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/blogs-d9105ab58414c63b.js.download"></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/contact-us-34f812ae60582ee6.js.download"></script><script src="./Jwt Authentication with Spring Boot 3.1 _ Learn Code With Durgesh_files/[category]-58d6b3faa4ef2b30.js.download"></script></body></html>
